<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/stevapps.png"><meta name="generator" content="Astro v4.16.14"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><!-- <link rel="preload" as="image" href={src} alt="Hero" /> --><title>Automating ETL Pipelines with Airflow for Data Orchestration to PostgreSQL (Data Warehouse). | Stevapps</title><link rel="canonical" href="https://astroship.web3templates.com/blog/python-automation/"><meta name="description" content="Stevapps Inc is developing Innovative Business Solutions For You."><meta name="robots" content="index, follow"><meta property="og:title" content="Stevapps is developing Innovative Business Solutions For You."><meta property="og:type" content="website"><meta property="og:image" content="https://astroship.web3templates.com/opengraph.png"><meta property="og:url" content="https://astroship.web3templates.com/blog/python-automation/"><meta property="og:image:url" content="https://astroship.web3templates.com/opengraph.png"><meta property="og:image:alt" content="Stevapps Homepage Screenshot"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@Stevapps"><meta name="twitter:creator" content="@stevalberts"><link rel="stylesheet" href="/_astro/about.B0F_z_lM.css"></head> <body> <div class="max-w-screen-xl mx-auto px-5">  <header class="flex flex-col lg:flex-row justify-between items-center my-5">  <div class="flex w-full lg:w-auto  items-center justify-between"> <a href="/" class="text-2xl"><span class="font-bold text-slate-800">Stevapps </span><span class="text-slate-500">Inc.</span> </a> <div class="block lg:hidden"> <button id="astronav-menu" aria-label="Toggle Menu">  <svg fill="currentColor" class="w-4 h-4 text-gray-800" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <title>Toggle Menu</title> <path class="astronav-close-icon astronav-toggle hidden" fill-rule="evenodd" clip-rule="evenodd" d="M18.278 16.864a1 1 0 01-1.414 1.414l-4.829-4.828-4.828 4.828a1 1 0 01-1.414-1.414l4.828-4.829-4.828-4.828a1 1 0 011.414-1.414l4.829 4.828 4.828-4.828a1 1 0 111.414 1.414l-4.828 4.829 4.828 4.828z"></path> <path class="astronav-open-icon astronav-toggle" fill-rule="evenodd" d="M4 5h16a1 1 0 010 2H4a1 1 0 110-2zm0 6h16a1 1 0 010 2H4a1 1 0 010-2zm0 6h16a1 1 0 010 2H4a1 1 0 010-2z"></path> </svg>  </button> </div> </div> <nav class="astronav-items astronav-toggle hidden w-full lg:w-auto mt-2 lg:flex lg:mt-0">  <ul class="flex flex-col lg:flex-row lg:gap-3"> <li> <a href="/" class="flex lg:px-3 py-2 items-center text-gray-600 hover:text-gray-900"> <span> Home</span>  </a> </li><li> <a href="/blog" class="flex lg:px-3 py-2 items-center text-gray-600 hover:text-gray-900"> <span> Blog</span>  </a> </li><li> <a href="/pricing" class="flex lg:px-3 py-2 items-center text-gray-600 hover:text-gray-900"> <span> Packages</span> <span class="ml-1 px-2 py-0.5 text-[10px] animate-pulse font-semibold uppercase text-white bg-indigo-600 rounded-full">
New
</span> </a> </li><li> <a href="/about" class="flex lg:px-3 py-2 items-center text-gray-600 hover:text-gray-900"> <span> About</span>  </a> </li> </ul> <div class="lg:hidden flex items-center mt-3 gap-4"> <!-- <Link href="#" style="muted" block size="md">Log in</Link> --> <a href="/contact" class="rounded text-center transition focus-visible:ring-2 ring-offset-2 ring-gray-200 w-full px-4 py-2 bg-black text-white hover:bg-gray-800  border-2 border-transparent">Contact </a> </div>  </nav>  <script>(function(){const closeOnClick = false;

["DOMContentLoaded", "astro:after-swap"].forEach((event) => {
  document.addEventListener(event, addListeners);
});

// Function to clone and replace elements
function cloneAndReplace(element) {
  const clone = element.cloneNode(true);
  element.parentNode.replaceChild(clone, element);
}

function addListeners() {
  // Clean up existing listeners
  const oldMenuButton = document.getElementById("astronav-menu");
  if (oldMenuButton) {
    cloneAndReplace(oldMenuButton);
  }

  const oldDropdownMenus = document.querySelectorAll(".astronav-dropdown");
  oldDropdownMenus.forEach((menu) => {
    cloneAndReplace(menu);
  });

  // Mobile nav toggle
  const menuButton = document.getElementById("astronav-menu");
  menuButton && menuButton.addEventListener("click", toggleMobileNav);

  // Dropdown menus
  const dropdownMenus = document.querySelectorAll(".astronav-dropdown");
  dropdownMenus.forEach((menu) => {
    const button = menu.querySelector("button");
    button &&
      button.addEventListener("click", (event) =>
        toggleDropdownMenu(event, menu, dropdownMenus)
      );

    // Handle Submenu Dropdowns
    const dropDownSubmenus = menu.querySelectorAll(
      ".astronav-dropdown-submenu"
    );

    dropDownSubmenus.forEach((submenu) => {
      const submenuButton = submenu.querySelector("button");
      submenuButton &&
        submenuButton.addEventListener("click", (event) => {
          event.stopImmediatePropagation();
          toggleSubmenuDropdown(event, submenu);
        });
    });
  });

  // Clicking away from dropdown will remove the dropdown class
  document.addEventListener("click", closeAllDropdowns);

  if (closeOnClick) {
    handleCloseOnClick();
  }
}

function toggleMobileNav() {
  [...document.querySelectorAll(".astronav-toggle")].forEach((el) => {
    el.classList.toggle("hidden");
  });
}

function toggleDropdownMenu(event, menu, dropdownMenus) {
  toggleMenu(menu);

  // Close one dropdown when selecting another
  Array.from(dropdownMenus)
    .filter((el) => el !== menu && !menu.contains(el))
    .forEach(closeMenu);

  event.stopPropagation();
}

function toggleSubmenuDropdown(event, submenu) {
  event.stopPropagation();
  toggleMenu(submenu);

  // Close sibling submenus at the same nesting level
  const siblingSubmenus = submenu
    .closest(".astronav-dropdown")
    .querySelectorAll(".astronav-dropdown-submenu");
  Array.from(siblingSubmenus)
    .filter((el) => el !== submenu && !submenu.contains(el))
    .forEach(closeMenu);
}

function closeAllDropdowns(event) {
  const dropdownMenus = document.querySelectorAll(".dropdown-toggle");
  const dropdownParent = document.querySelectorAll(
    ".astronav-dropdown, .astronav-dropdown-submenu"
  );
  const isButtonInsideDropdown = [
    ...document.querySelectorAll(
      `.astronav-dropdown button, .astronav-dropdown label, .astronav-dropdown input,
	  .astronav-dropdown-submenu button, .astronav-dropdown-submenu label, .astronav-dropdown-submenu input,
	  #astronav-menu`
    ),
  ].some((button) => button.contains(event.target));
  if (!isButtonInsideDropdown) {
    dropdownMenus.forEach((d) => {
      // console.log("I ran", d);
      // if (!d.contains(event.target)) {
      d.classList.remove("open");
      d.removeAttribute("open");
      d.classList.add("hidden");
      // }
    });
    dropdownParent.forEach((d) => {
      d.classList.remove("open");
      d.removeAttribute("open");
      d.setAttribute("aria-expanded", "false");
    });
  }
}

function toggleMenu(menu) {
  menu.classList.toggle("open");
  const expanded = menu.getAttribute("aria-expanded") === "true";
  menu.setAttribute("aria-expanded", expanded ? "false" : "true");
  menu.hasAttribute("open")
    ? menu.removeAttribute("open")
    : menu.setAttribute("open", "");

  const dropdownToggle = menu.querySelector(".dropdown-toggle");
  const dropdownExpanded = dropdownToggle.getAttribute("aria-expanded");
  dropdownToggle.classList.toggle("hidden");
  dropdownToggle.setAttribute(
    "aria-expanded",
    dropdownExpanded === "true" ? "false" : "true"
  );
}

function closeMenu(menu) {
  // console.log("closing", menu);
  menu.classList.remove("open");
  menu.removeAttribute("open");
  menu.setAttribute("aria-expanded", "false");
  const dropdownToggles = menu.querySelectorAll(".dropdown-toggle");
  dropdownToggles.forEach((toggle) => {
    toggle.classList.add("hidden");
    toggle.setAttribute("aria-expanded", "false");
  });
}

function handleCloseOnClick() {
  const navMenuItems = document.querySelector(".astronav-items");
  const navToggle = document.getElementById("astronav-menu");
  const navLink = navMenuItems && navMenuItems.querySelectorAll("a");

  const MenuIcons = navToggle.querySelectorAll(".astronav-toggle");

  navLink &&
    navLink.forEach((item) => {
      item.addEventListener("click", () => {
        navMenuItems?.classList.add("hidden");
        MenuIcons.forEach((el) => {
          el.classList.toggle("hidden");
        });
      });
    });
}
})();</script> <div> <div class="hidden lg:flex items-center gap-4"> <a href="/contact" class="rounded text-center transition focus-visible:ring-2 ring-offset-2 ring-gray-200 px-4 py-2 bg-black text-white hover:bg-gray-800  border-2 border-transparent">Contact </a> </div> </div> </header>  </div>  <div class="max-w-screen-xl mx-auto px-5">  <div class="mx-auto max-w-3xl mt-14"> <span class="text-blue-400 uppercase tracking-wider text-sm font-medium"> Data Engineering </span> <h1 class="text-4xl lg:text-5xl font-bold lg:tracking-tight mt-1 lg:leading-tight"> Automating ETL Pipelines with Airflow for Data Orchestration to PostgreSQL (Data Warehouse). </h1> <div class="flex gap-2 mt-3 items-center flex-wrap md:flex-nowrap"> <span class="text-gray-400"> Steven Ogwal </span> <span class="text-gray-400">•</span> <time class="text-gray-400" datetime="2024-11-14T21:00:00.000Z"> Fri Nov 15 2024 </time> <span class="text-gray-400 hidden md:block">•</span> <div class="w-full md:w-auto flex flex-wrap gap-3"> <span class="text-sm text-gray-500">#Airflow</span><span class="text-sm text-gray-500">#Python</span><span class="text-sm text-gray-500">#SQL</span> </div> </div> </div> <div class="mx-auto prose prose-lg mt-6 max-w-3xl"> <p>This project requires robust data pipelines that can efficiently process high-volume datasets. To address this, I engineered an Inflation Analysis System using an automated ETL workflow. The pipeline extracts data from disparate sources, transforms it into a star schema in PostgreSQL (Data warehouse), and integrates with BI tools for real-time visualization and analytics. Orchestrated with Apache Airflow, the system ensures scalability, automation, and reliability.</p>
<h3 id="challenge">Challenge</h3>
<p>The challenge was to process weekly food price data from web sources and transform it into actionable insights. To meet this need, the ETL system was designed to:</p>
<ul>
<li>Extract: Automate ingestion of structured data from web APIs.</li>
<li>Transform: Normalize and structure the data into a star schema optimized for analytical queries.</li>
<li>Load: Store the transformed data in PostgreSQL, ensuring data integrity and accessibility.</li>
<li>Visualize: Enable decision makers to explore inflation trends through BI dashboards.</li>
</ul>
<h2 id="system-architecture">System Architecture</h2>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5FyV4OM21R1HD4UvApFf6A.png" alt="ETL System Diagram"></p>
<h3 id="tools-and-technologies">Tools and Technologies</h3>
<ul>
<li>ETL Orchestration: Apache Airflow for automation and scheduling.</li>
<li>Database: PostgreSQL for data warehousing and OLAP.</li>
<li>Programming Language: Python for data manipulation and API interaction.</li>
<li>Visualization: Power BI for dynamic reporting and trend analysis.</li>
</ul>
<h2 id="etl-pipeline-design">ETL Pipeline Design</h2>
<p>The pipeline adheres to a modular workflow orchestrated in Apache Airflow:</p>
<ul>
<li>Data Extraction: Fetches weekly datasets from web sources and stores them in raw format.</li>
<li>Data Transformation: Processes data into fact and dimension tables using Python and Pandas.</li>
<li>Data Loading: Loads the star schema into PostgreSQL.</li>
<li>BI Integration: Connects PostgreSQL to Power BI for interactive visualizations.</li>
</ul>
<h3 id="implementation-details">Implementation Details</h3>
<ol>
<li>
<h4 id="data-extraction">Data Extraction</h4>
</li>
</ol>
<p>The extraction stage uses Python’s requests library to interact with a RESTful API. Airflow schedules and monitors this task to ensure reliability.</p>
<ol start="2">
<li>
<h4 id="data-transformation">Data Transformation</h4>
</li>
</ol>
<p>The raw data is normalized into a star schema. A fact table stores price metrics, while dimension tables capture commodities, regions, and dates.
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pqSyfaglryCX9LcE_vN4MQ.png" alt="Data Transformation">
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FTWFvDK8YTm76fPTqQCkgw.png" alt="Data Transformation"></p>
<ol start="3">
<li>
<h4 id="data-loading">Data Loading</h4>
</li>
</ol>
<p>The transformed data is loaded into PostgreSQL, enabling optimized querying for BI tools.
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQ2y4k5G6Iw5dEjjQzmhhQ.png" alt="Data Loading"></p>
<ol start="4">
<li>
<h4 id="automation-with-airflow-dags">Automation with Airflow DAGs</h4>
</li>
</ol>
<p>Apache Airflow is critical for orchestrating each stage of the ETL pipeline, enabling automated, reliable data workflows. In this setup, Airflow DAGs (Directed Acyclic Graphs) define the sequence and dependencies of tasks from extraction to visualization. The DAG is scheduled to run weekly to match the incoming data cadence, ensuring fresh data is processed and loaded into the data warehouse in PostgreSQL.
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y81SG5CTbAnZSw6Ql-lLZg.png" alt="Data Loading"></p>
<ol start="5">
<li>
<h4 id="test-logs-and-monitoring">Test Logs and Monitoring</h4>
</li>
</ol>
<p>To ensure data quality and pipeline reliability, the ETL system incorporates comprehensive logging and monitoring mechanisms. Each stage of the pipeline logs its execution details, including task statuses, processing times, and potential errors. These logs are stored in a dedicated logs table in PostgreSQL, allowing for centralized monitoring and historical tracking
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlgVn9JBLDyV9c9XlQy6aQ.png" alt="Data Loading">
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AAEaUppLJqqfaVQ-WGVS3g.png" alt="Data Loading"></p>
<h2 id="visualization-and-insights">Visualization and Insights</h2>
<p>Using BI tools (eg. Power BI, Tableau,Looker Studio) the PostgreSQL database is connected to create visualizations such as:</p>
<ul>
<li>Inflation trends by region and commodity.</li>
<li>Year-over-year price comparisons.</li>
<li>Forecasting future price changes.</li>
<li>These dashboards enable stakeholders to make data-driven decisions - based on reliable and timely data.</li>
</ul>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aw8LVmIyxA8H96Zs6rlVlQ.png" alt="Data Loading"></p>
<p>Try it: <a href="https://lookerstudio.google.com/reporting/042ab5ef-2863-4bfb-a119-2bb2765742e2">https://lookerstudio.google.com/reporting/042ab5ef-2863-4bfb-a119-2bb2765742e2</a></p>
<h2 id="conclusion">Conclusion</h2>
<p>This Inflation Analysis System demonstrates the power of data engineering principles in solving real-world challenges. The automated ETL pipeline, built with Airflow and PostgreSQL, provides a scalable and efficient foundation for economic insights. By integrating BI tools, the system transforms raw data into actionable intelligence for better decision-making.</p> </div> <div class="text-center mt-8"> <a href="/blog" class="bg-gray-100 px-5 py-3 rounded-md hover:bg-gray-200 transition">← Back to Blog</a> </div>  </div>  <footer class="my-20"> <p class="text-center  text-slate-500">
Copyright © 2024 Stevapps Inc. All rights reserved.
</p> <!--
    Can we ask you a favor 🙏
    Please keep this backlink on your website if possible.
    or Purchase a commercial license from https://web3templates.com
  --> <p class="text-center text-slate-500 mt-1">
Made by <a href="https://www.linkedin.com/in/steven-a-ogwal-50840912b/" target="_blank" rel="noopener" class="hover:underline">
StevalbertS
</a> </p> </footer>  </body> </html>